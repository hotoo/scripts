<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
<head>
<meta name="generator" content="Editplus" />
<meta name="author" content="闲耘 (mail[AT]xianyun.org)" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<title>Crazy - Javascript Efficiency Test Framework</title>
<link type="text/css" rel="stylesheet" href="crazy.css" />
<script type="text/javascript" src="common.js"></script>
<script type="text/javascript" src="io.js"></script>
<script type="text/javascript" src="Crazy.js"></script>
<script type="text/javascript">/*<![CDATA[*/
function println(){document.write([].join.call(arguments)+"<br />");}
function $(id){return document.getElementById(id);}

function loadBefore(){
    document.body.style.cursor="wait";
    $("btn-run").disabled = true;
    $("jspath").disabled = true;
    $("btn-load-path").disabled = true;
    $("jsuri").disabled = true;
    $("btn-load-src").disabled = true;
}
function loadBack(){
    document.body.style.cursor="";
    $("btn-run").disabled = false;
    $("jspath").disabled = false;
    $("btn-load-path").disabled = false;
    $("jsuri").disabled = false;
    $("btn-load-src").disabled = false;
}
// for local file.
function loadPath(src){
    loadBefore();
    window.$import(src, loadBack);
}
// for remote resource.
function loadUri(src){
    loadBefore();
    window.$import(src,loadBack);
}


function runbefore(){
    $("btn-run").disabled=true;
    $("btn-average").disabled = true;
    $("btn-clear").disabled = true;
    loadBefore();
    $("btn-run").value="RUNNING...";
}
function runback(){
    $("btn-run").value="RUN";
    loadBack();
    $("btn-run").disabled = false;
    $("btn-average").disabled = false;
    $("btn-clear").disabled = false;
}
var CRAZY_INSTANCE=null;
function crazyInstance(crazy){
    if(CRAZY_INSTANCE){return CRAZY_INSTANCE;}
    var cs=crazy();
    if(!cs){alert("未找到被测试函数。"); runback(); return;}
    if(cs instanceof Array){
        CRAZY_INSTANCE=[];
        var l=cs.length-1,
            c = new Crazy(cs[l].funs, cs[l].args, cs[l].times, runback);
            c.out = $("out");
            CRAZY_INSTANCE[CRAZY_INSTANCE.length] = c;
        for(var i=l-1; i>=0; i--){
            CRAZY_INSTANCE[CRAZY_INSTANCE.length] = c =
              new Crazy(cs[i].funs, cs[i].args, cs[i].times, Function.createDelegate(c, c.test));
            c.out = $("out");
        }
        return CRAZY_INSTANCE;
    }else{
        return CRAZY_INSTANCE=[new Crazy(cs.funs, cs.args, cs.times, runback)];
    }
}
function run(){
    runbefore();
    var ci=crazyInstance(crazyIt);
    ci[ci.length-1].test();
}
function average(){
    if(!crazyIt){return;}
    var inst = crazyInstance(crazyIt);
    for(var i=inst.length-1; i>=0; i--){
        inst[i].average();
    }
}
function clean(){
    $("out").innerHTML="";
}
/*]]>*/</script>
</head>
<body>
<div id="top">
<form method="post" action="javascript:void(0);" onsubmit="return false;">
<table style="border-collapse:collapse; border-spacing:0; width:95%;">
<tr>
    <td rowspan="2" width="100" style="padding:0 2em 0 0;"><p>
        <input type="submit" id="btn-run" disabled="disabled" onclick="run();" value="RUN" /></p></td>
    <td width="500"><p><input type="file" id="jspath" name="jspath" onchange="loadPath(this.value)" />
        <input type="button" id="btn-load-path" onclick="loadPath($('jspath').value)" value="Load Local File(for cache)" /></p>
    </td>
    <td align="rigth">
        <a id="helpLink" href="help.html">Help</a>
    </td>
</tr>
<tr>
    <td>
        <input type="text" id="jsuri" name="jsuri" />
        <input type="button" id="btn-load-src" onclick="loadUri($('jsuri').value);" value="Load Remote Resource" />
        eg. <a href="http://hotoo.googlecode.com/svn/trunk/labs/js/crazy/repeat.js">repeat</a>, 
        <a href="http://hotoo.googlecode.com/svn/trunk/labs/js/crazy/pad.js">pad</a>, 
        <a href="http://hotoo.googlecode.com/svn/trunk/labs/js/crazy/isOdd.js">isOdd</a>
    </td>
    <td align="right">
        <input type="button" id="btn-average" value="average" onclick="average();" />
        <input type="button" id="btn-clear" value="clear" onclick="clean();" />
    </td>
</tr></table>
</form>
<h3><span>Copyleft &copy; 2009 <a href="http://www.xianyun.org">xianyun.org</a>, version 1.3</span>Results</h3>
</div>
<div id="out"></div>

</body>
</html>
