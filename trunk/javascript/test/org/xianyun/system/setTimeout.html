<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="utf-8">
<html>
<head>
<title>t</title>
<meta name="generator" content="Editplus" />
<meta name="author" content="闲耘 (mail[AT]xianyun.org)" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
<div id='out'></div>

<script>
// test setTimeout("exp",0)
function fun(){
	alert(arguments.length);
}
window.setTimeout(fun,1000,2);

window.setTimeout(function(){
if(arguments.length==0){
	var st = window.setTimeout;
	window.setTimeout = function(fn, dli) {
		var t=new Date().getTime();
		if(typeof fn == 'function'){
			var args = Array.prototype.slice.call(arguments,2);
			var f = function(){
				args.push(new Date().getTime()-t-dli);  //该行用于实现对实际延迟和设定延迟的差值，同FF的最后一个参数，无实际意义
				fn.apply(null, args)
			};
			return st(f, dli);
		}
		return st(fn,dli);
	}
}
},0);

window.setTimeout(function(){
	var d0=new Date();
	setTimeout(function(d){
		return document.getElementById('out').innerHTML=((new Date()-d0-100)+", "+d);
	}, 100);
},100,1);
</script>
</body>
</html>