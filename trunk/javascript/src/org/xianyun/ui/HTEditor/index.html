<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>HTEditor</title>
<meta name="Generator" content="EditPlus">
<meta name="Author" content="">
<meta name="Keywords" content="">
<meta name="Description" content="">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style>

</style>
</head>
<body>
<script language="JavaScript">
<!--

var HTEditor = function(oTextarea){
    this.textarea = oTextarea || null;
    this.iframe = null;
    this.content = this.textarea.innerHTML || '';
    this.init();
};
HTEditor.ui = new Object();
HTEditor.ui['default'] = {
    save : '',
    blod : ''
};
HTEditor.ui['red'] = {
    save : '',
    blod : ''
};
HTEditor.prototype.init = function(){
    this.iframe = document.createElement('iframe');
    this.iframe.width = this.textarea.style.width;
    this.iframe.height = this.textarea.style.height;
    this.textarea.style.display = 'none';
    document.body.appendChild(this.iframe);
    this.iframe.contentWindow.document.designMode = 'on';
    this.iframe.contentWindow.document.contentEditable = true;
    this.iframe.contentWindow.document.open();
    this.iframe.contentWindow.document.writeln('<html><body></body></html>');
    this.iframe.contentWindow.document.close();
};
HTEditor.prototype.toBlod = HTEditor.prototype.toStrong = function(){
    this.iframe.contentWindow.focus();
    try{asdf();
         //所有字体特效只是使用execComman()就能完成。
        this.iframe.contentWindow.document.execCommand("Bold", false, null);
    }catch(e){//alert('blod');
        var sel = this.iframe.contentWindow.document.selection.createRange();
        this.insertHTML("<strong>"+sel.text+"</strong>");
    }
};
HTEditor.prototype.insertHTML = function(html){
     if (this.iframe.contentWindow.document.selection.type.toLowerCase() != "none"){
         this.iframe.contentWindow.document.selection.clear();
     }
     this.iframe.contentWindow.document.selection.createRange().pasteHTML(html) ; 
};
HTEditor.prototype.getHTML = function(){
    return this.iframe.contentWindow.document.body.innerHTML;
};
HTEditor.prototype.setHTML = function(html){
    this.iframe.contentWindow.document.body.innerHTML = html;
};
HTEditor.prototype.syncContent = function(){
    this.textarea.value = this.iframe.contentWindow.document.body.innerHTML;
};

//-->
</script>

<form method=post action="">
    <textarea name="textarea1" rows="4" cols="8" style="width:500px;height:300px"></textarea><br />
    <input type="button" value="Save" onclick="alert(editor.getHTML());">
    <input type="button" value="Strong" onclick="editor.toStrong();">
</form>

<script language="JavaScript">
<!--
var editor = new HTEditor(document.getElementById('textarea1'));
//-->
</script>
</body>
</html>
