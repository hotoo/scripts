<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="utf-8">
<html>
<head>
<title>c</title>
<meta name="generator" content="Editplus" />
<meta name="author" content="闲耘 (mail[AT]xianyun.org)" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
<div id="unrepeat"></div>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="abc"></div><div id="abc"></div><span id="abc"></span><div id="def"></div><div id="abc"></div><div id="abc"></div><span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<div id="abc"></div>
<div id="abc"></div>
<div id="abc"></div>
<span id="abc"></span>
<div id="def"></div>
<a id="def"></a>
<a id="def"></a>
<script type="text/javascript" language="javascript">/*<![CDATA[*/
function chkid(){
    var did={}
    divs = document.getElementsByTagName("*");
    for (var i=0,l=divs.length; i<l; i++){
        divs[i].getAttribute("id")
            ?did[divs[i].getAttribute("id")]===undefined
                ?did[divs[i].getAttribute("id")]=0
                :did[divs[i].getAttribute("id")]++
            :0;
    }
	var r=[];
    for (var i in did) {
		if(did[i]){r[r.length]={id:i,length:did[i]+1};}
    }
	return r;
}

	var chkId=function(){
		var ro={}, ri=[], id, e=document.getElementsByTagName("*");
		for(var i=0, l=e.length; i<l; i++){
			id=e[i].getAttribute("id")||e[i].id||"";
			if(!id){continue;}
			if(!ro["chkid_"+id]){ro["chkid_"+id]={id:id,length:0};}
			ro["chkid_"+id].length++;
			//

			continue;
//			ro["chkID_"+id]=(ro["chkID_"+id]||0)+1;
//			if(ro["chkID_"+id]<2){continue;}
			if(ro["chkid_"+id]==undefined){ro["chkid_"+id]=ri.length;}
//			ri[ro["chkIndex_"+id]]={id:id,length:ro["chkID_"+id]};
			if(!ri[ro["chkIndex_"+id]]){ri[ro["chkIndex_"+id]]={id:id};}
//			ri[ro["chkIndex_"+id]].id=id;
			ri[ro["chkIndex_"+id]].length=(ri[ro["chkIndex_"+id]].length||0)+1;
		}
		return ri;
	};

function compare(){
	var I=200;
	var d0=new Date();
	for (var i=0; i<I; i++){
		chkid();
	}
	d0=new Date-d0;

	var d1=new Date();
	for (var i=0; i<I; i++){
		chkId();
	}
	d1=new Date-d1;
	return [d0,d1];
}
function str(r){
	var s="";
	for (var i=0, l=r.length; i<l; i++){
		s+=r[i].id+" : "+r[i].length+"\n";
	}
	return s;
}
window.onload=function(){
	alert(compare());
	alert(str(chkid()));
	alert(str(chkId()));
};
/*]]>*/</script>
</body>
</html>